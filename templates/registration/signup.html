{% extends 'base.html' %}

{% block title %}注册 - {{ block.super }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card shadow-sm">
            <div class="card-header text-center">
                <h4 class="mb-0">
                    <i class="bi bi-person-plus"></i> 用户注册
                </h4>
            </div>
            <div class="card-body">
                <form method="POST">
                    {% csrf_token %}
                    
                    <!-- 显示错误信息 -->
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger" role="alert">
                            {% for error in form.non_field_errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                    
                    <!-- 基本信息 -->
                    <h6 class="text-muted mb-3">基本信息</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.username.id_for_label }}" class="form-label">
                                    <strong>用户名 <span class="text-danger">*</span></strong>
                                </label>
                                {{ form.username }}
                                {% if form.username.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.username.errors }}
                                    </div>
                                {% endif %}
                                <div class="form-text">
                                    3-20个字符，只能包含字母、数字和下划线
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.email.id_for_label }}" class="form-label">
                                    <strong>邮箱</strong>
                                </label>
                                {{ form.email }}
                                {% if form.email.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.email.errors }}
                                    </div>
                                {% endif %}
                                <div class="form-text">
                                    用于找回密码和接收通知（可选）
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 密码信息 -->
                    <h6 class="text-muted mb-3">密码设置</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.password1.id_for_label }}" class="form-label">
                                    <strong>密码 <span class="text-danger">*</span></strong>
                                </label>
                                {{ form.password1 }}
                                {% if form.password1.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.password1.errors }}
                                    </div>
                                {% endif %}
                                <div class="form-text">
                                    至少8个字符，建议包含字母和数字
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.password2.id_for_label }}" class="form-label">
                                    <strong>确认密码 <span class="text-danger">*</span></strong>
                                </label>
                                {{ form.password2 }}
                                {% if form.password2.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.password2.errors }}
                                    </div>
                                {% endif %}
                                <div class="form-text">
                                    请再次输入密码
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 个人信息 -->
                    <h6 class="text-muted mb-3">个人信息（可选）</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.first_name.id_for_label }}" class="form-label">
                                    <strong>姓名</strong>
                                </label>
                                {{ form.first_name }}
                                {% if form.first_name.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.first_name.errors }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.last_name.id_for_label }}" class="form-label">
                                    <strong>姓氏</strong>
                                </label>
                                {{ form.last_name }}
                                {% if form.last_name.errors %}
                                    <div class="text-danger small mt-1">
                                        {{ form.last_name.errors }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- 条款同意 -->
                    <div class="mb-3">
                        <div class="form-check">
                            {{ form.agree_terms }}
                            <label class="form-check-label" for="{{ form.agree_terms.id_for_label }}">
                                我已阅读并同意
                                <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#termsModal">用户协议</a>
                                和
                                <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#privacyModal">隐私政策</a>
                            </label>
                        </div>
                        {% if form.agree_terms.errors %}
                            <div class="text-danger small mt-1">
                                {{ form.agree_terms.errors }}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle"></i> 注册账号
                        </button>
                    </div>
                </form>
            </div>
            <div class="card-footer text-center">
                <div class="mb-2">
                    <small class="text-muted">已有账号？</small>
                    <a href="{% url 'login' %}" class="text-decoration-none">立即登录</a>
                </div>
                {% if next %}
                <div>
                    <small class="text-muted">注册后将跳转到: {{ next }}</small>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- 用户协议模态框 -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">用户协议</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>欢迎使用我们的论坛平台</h6>
                <p>通过注册和使用本平台，您同意遵守以下条款：</p>
                <ul>
                    <li>遵守相关法律法规，文明用语</li>
                    <li>不发布违法违规内容</li>
                    <li>尊重他人知识产权</li>
                    <li>维护平台安全和稳定</li>
                    <li>合理使用平台资源</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<!-- 隐私政策模态框 -->
<div class="modal fade" id="privacyModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">隐私政策</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>我们如何保护您的隐私</h6>
                <ul>
                    <li>收集必要的用户信息以提供服务</li>
                    <li>不会向第三方泄露您的个人信息</li>
                    <li>使用加密技术保护数据传输</li>
                    <li>您可以随时删除或修改个人信息</li>
                    <li>严格控制管理员权限和数据访问</li>
                </ul>
                <p class="small text-muted mt-3">
                    如有隐私相关问题，请联系管理员。
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}